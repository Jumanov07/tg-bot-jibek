require("dotenv").config();
const { Telegraf } = require("telegraf");

// Инициализация бота с токеном из переменной окружения
const bot = new Telegraf(process.env.TOKEN);

// 🎯 Список категорий с текстами
const categories = {
  "Өзүңдү өнүктүрүү": [
    "30 мүнөт ой жүгүртүү (медитация)",
    "Өзүңө кат жаз",
    "Бир жаңы макаланы же китептин бөлүмүн оку",
    "5 жылдык келечекке максат жаз",
    "Бир күн телефонсуз өткөр",
    "3 саат социалдык тармаксыз бол",
    "Чет тилинде 10 жаңы сөз жатта",
    "Жашооңдо эмнеге ыраазы экениңди жаз",
    "Тааныш эмес адам менен сүйлөш",
    "Күндөлүккө жашооң тууралуу 1 бет жаз",
  ],
  Чыгармачылык: [
    "10 мүнөт эч токтобой эркин жазуу жаса",
    "1 сүрөт тарт",
    "Жаңы ырдын текстин жаз",
    "Кол менен бир нерсе жасоого аракет кыл (handmade)",
    "Сүйүктүү тасмаңдын сюжети боюнча башкача бүтүрүп жаз",
    "Көздөрүңдү жуумп 5 мүнөт ырдап көр",
    "Бир күн бою сүрөттөр менен эле айтып берүү (телефон аркылуу)",
    "Жаңы тамак жасап көр",
    "Фотосессия кыл",
    "Окуган китебиңден кызыктуу цитаталарды бөлүш",
  ],
  "Физикалык өнүгүү": [
    "10 мүнөт йога жаса",
    "5 км бас",
    "Муздак суу менен жуун",
    "Бир күн таттуу жебей көр",
    "50 жолу отуруп-тур",
    "Бир күн бою 2 литр суу ич",
    "Жаңы машыгуу аракет кыл",
    "Бир күн бою басып жүр",
    "Үйдө 15 мүнөт бийле",
    "Денеңди сундуруу көнүгүүлөрүн жаса",
  ],
  "Жашоо стили жана көндүмдөр": [
    "Бир күн эрте ойгон",
    "Жаңы рецепт менен тамак жаса",
    "Өзүң каалаган кийим стилинде кийин",
    "Бир күн бою соцтармактарсыз бол",
    "1 саат эч ким менен сүйлөшпөй көр",
    "Бир жумага пландарды жаз",
    "Күн тартибиңди өзгөртүп көр",
    "Бир күн бою жаңы нерселерди байкоого аракет кыл",
    "Тазалык күнүн өткөр",
    "Күндүн акырында өзүңө отчет жаз",
  ],
};

// 🚀 Стартовая команда
bot.start((ctx) => {
  const keyboard = {
    reply_markup: {
      keyboard: Object.keys(categories).map((cat) => [cat]),
      resize_keyboard: true,
    },
  };
  ctx.reply("👋 Салам! Категорияны танда:", keyboard);
});

// 🎲 Обработка выбора категории
bot.on("text", (ctx) => {
  const category = ctx.message.text;
  if (categories[category]) {
    const randomText =
      categories[category][
        Math.floor(Math.random() * categories[category].length)
      ];
    ctx.reply(`📌 ${category} категориясынан тапшырма:\n\n${randomText}`);
  } else {
    ctx.reply("⚠️ Сураныч, категорияны тандаңыз.");
  }
});

// 🌐 Веб-сервер үчүн
const express = require("express");
const app = express();
const PORT = process.env.PORT || 3000;

app.get("/", (req, res) => {
  res.send("Телеграм бот иштеп жатат! 🚀");
});

app.listen(PORT, () => {
  console.log(`🌐 Веб-сервер иштеп жатат: http://localhost:${PORT}`);
});

// 🔄 Запуск бота
bot.launch();

console.log("🤖 Бот кыргыз тилинде иштеп жатат!");
